workflows:
  ios-init:
    name: Init iOS Project on macOS
    environment:
      groups:
        - github_access
      flutter: stable
      xcode: latest
      vars:
        GIT_BRANCH: "main" # ou "master" selon ton cas
    scripts:
      - name: Remove existing ios folder (if any)
        script: |
          rm -rf ios
      - name: Generate iOS folder
        script: |
          flutter create .
      - name: Push ios/ to GitHub
        script: |
          git config --global user.name "Codemagic Bot"
          git config --global user.email "codemagic@bot.com"
          git remote set-url origin https://oauth2:${GITHUB_TOKEN}@github.com/<TON_UTILISATEUR>/flutter_ios_template.git
          git add ios/
          git commit -m "Add ios folder generated by Codemagic"
          git push origin $GIT_BRANCH
